
Configuration successful
===================================================================

hafoe will execute with the following parameters:
	explore = TRUE 
	identify = TRUE 
	scripts.dir = ./src 
	bowtie.build.path = /usr/bin/bowtie2-build 
	bowtie.align.path = /usr/bin/bowtie2 
	samtools.path = /usr/bin/samtools 
	cd_hit_est.path = /storage2/proj/kodikaz/softwares/cdhit/cd-hit-est 
	cd_hit_est_2d.path = /storage2/proj/kodikaz/softwares/cdhit/cd-hit-est-2d 
	clustalo.path = /usr/bin/clustalo 
	parent.path = input_files/AAV_all16_new.fasta 
	chimeric.lib.path = input_files/Chimeric_lib_simulated.csv 
	enriched.path = input_files/Enriched_lib_simulated.fastq.gz 
	output.dir =  hafoe_out_sim_100_15 
	num.proc = 4 
	read_length = 100 
	overlap = TRUE 
	step_size = 15 

Checking and installing dependencies
===================================================================

Following R packages were installed and/or called:
	dplyr: version 1.0.9
	ORFik: version 1.12.13
	plotly: version 4.10.0
	ggplot2: version 3.3.6
	gplots: version 3.1.3
	microseq: version 2.1.4
	Biostrings: version 2.60.2
	stringr: version 1.4.0
	cowplot: version 1.1.1
	seqinr: version 4.2.8


Filtering the input libraries by ORF and original sequence lengths
===================================================================

Filtering the chimeric library
-------------------------------------------------------------------
File: input_files/Chimeric_lib_simulated.fasta
Minimum ORF length: 600
Maximum sequence length: 3000
Number of sequences before filtering: 7759
Number of sequences after filtering: 7254
ORF length summary statistics
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   2181    2211    2214    2213    2217    2226 

Filtering the enrichment cycle 1 library
-------------------------------------------------------------------
File: input_files/Enriched_lib_simulated.fastq.gz
Minimum ORF length: 600
Maximum sequence length: 3000
Number of sequences before filtering: 3024
Number of sequences after filtering: 2811
ORF length summary statistics
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   2181    2211    2214    2214    2217    2226 



Clustering the filtered chimeric library
===================================================================

Program: cd-hit-est
Command: /storage2/proj/kodikaz/softwares/cdhit/cd-hit-est 
	 -i hafoe_out_sim_100_15/files/Chimeric_ORF.fasta 
	 -o hafoe_out_sim_100_15/files/clstr_chimeric_lib/clstr_chim.fasta 
	 -g 1 
	 -d 100 
	 -c 0.9 
	 -n 9 
	 -G 0 
	 -aL 0.9 
cd-hit-est path: /storage2/proj/kodikaz/softwares/cdhit/cd-hit-est 
Input path: hafoe_out_sim_100_15/files/Chimeric_ORF.fasta 
Output path: hafoe_out_sim_100_15/files/clstr_chimeric_lib 
Log path: hafoe_out_sim_100_15/log/cd_hit_est.log 
Sequence identity threshold, default 0.9 (-c): 0.9 
Identity type, default 1 (-G):  0 
	(if set to 1, use global sequence identity, 
	if set to 0, then use local sequence identity, 
	calculated as number of identical bases in alignment
	divided by the length of the alignment) 
Alignment coverage for the longer sequence, default 0.0 (-aL): 0.9 
word_length, default 10, see CD-HIT user's guide for choosing it (-n): 9 

Number of clusters: 89
Cluster size summary statistics
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   4.00   32.00   48.00   81.51  114.00  498.00 


Choosing new representative sequences for the clusters
===================================================================

Choosing a new representative ORF sequence for each cluster based on: 
	1. greatest sequence abundance in the input chimeric library
	2. maximum ORF length
Output path: hafoe_out_sim_100_15/files/clstr_chimeric_lib/clstr_chim_new.fasta


Plotting the cluster size distribution
===================================================================

Output path: hafoe_out_sim_100_15/reports/cluster_size_distr_chimeric_lib.pdf


Building index on parental library
===================================================================

Command: /usr/bin/bowtie2-build 
	 input_files/AAV_all16_new.fasta  
	 hafoe_out_sim_100_15/files/parent_index/AAV 
bowtie2-build path: /usr/bin/bowtie2-build 
Input path: input_files/AAV_all16_new.fasta 
Output path: hafoe_out_sim_100_15/files/parent_index 
Log path: hafoe_out_sim_100_15/log/bowtie_build.log 


Doing variant description on chimeric library representatives
===================================================================


Making fastq files for chimeric library representatives
-------------------------------------------------------------------

Chopping each representative sequence into fragments of fixed size and storing into fastq files 
Fragment length: 100
Use overlapping fragments (TRUE/FALSE): TRUE
Step size: 15
Output path: hafoe_out_sim_100_15/files/variant_description/chimeric_lib_representatives/fastq


Aligning chimeric library representatives on parental index
-------------------------------------------------------------------

Command: /usr/bin/bowtie2 
	 -p 4 
	 -a 
	 --no-unal 
	 -L 30 
	 -D 2 
	 -x hafoe_out_sim_100_15/files/parent_index/AAV  
	 --un hafoe_out_sim_100_15/files/variant_description/chimeric_lib_representatives/unmapped/.fq 
	 -S hafoe_out_sim_100_15/files/variant_description/chimeric_lib_representatives/sam/.sam 
bowtie2 path: /usr/bin/bowtie2 
Reference index path: hafoe_out_sim_100_15/files/parent_index/AAV 
Output path for mapped reads: hafoe_out_sim_100_15/files/variant_description/chimeric_lib_representatives/bam 
Output path for unmapped reads: hafoe_out_sim_100_15/files/variant_description/chimeric_lib_representatives/unmapped 
Log path: hafoe_out_sim_100_15/log/bowtie_align_representatives.log 
Seed length (-L): 30 
Number of seed extention failed attemps, default 15 (-D): 2 
	(Up to <int> consecutive seed extension attempts can fail
	before Bowtie 2 moves on, using the alignments found so far. 
	A seed extension fails if it does not yield a new best or
	a new second-best alignment. This limit is automatically 
	adjusted up when -k or -a are specified.) 

Running...: 0% done
Elapsed Time: 0 seconds

Running...: 25% done
Elapsed Time: 4 seconds

Running...: 50% done
Elapsed Time: 7 seconds

Running...: 75% done
Elapsed Time: 10 seconds

Running...: 100% done
Elapsed Time: 14 seconds


Getting required files for variant description
-------------------------------------------------------------------


Processing mapped reads


Running...: 0% done
Elapsed Time: 0 seconds

Running...: 25% done
Elapsed Time: 0 seconds

Running...: 50% done
Elapsed Time: 0 seconds

Running...: 75% done
Elapsed Time: 1 seconds

Running...: 100% done
Elapsed Time: 1 seconds


Processing unmapped reads


Running...: 0% done
Elapsed Time: 0 seconds

Running...: 25% done
Elapsed Time: 0 seconds

Running...: 50% done
Elapsed Time: 1 seconds

Running...: 75% done
Elapsed Time: 1 seconds

Running...: 100% done
Elapsed Time: 1 seconds


Doing neighbor-aware serotype identification
-------------------------------------------------------------------

Output path: hafoe_out_sim_100_15/files/variant_description/chimeric_lib_representatives/chimeric_lib_representatives_variant_description.csv

Abundance of AAV serotypes in the chimeric library
                   Freq(%)
AAV2                 22.53
AAVrh8               18.68
no alignment         10.80
AAV6                 10.54
AAV9                  7.84
AAV7                  7.73
AAV8                  6.65
multiple alignment    4.70
AAV13                 3.26
AAV1                  2.54
AAV5                  2.25
AAVrh10               1.11
AAV3                  1.05
AAV10                 0.31
AAV4                  0.00
AAV11                 0.00
AAV12                 0.00
AAVrh32               0.00


Plotting the cluster abundance
===================================================================

Output path: hafoe_out_sim_100_15/reports/cluster_abundance_chimeric_lib.pdf


Plotting variant description of chimeric library representatives
===================================================================

Output path: hafoe_out_sim_100_15/reports/variant_description_chimeric_rep.pdf


Plotting distribution of AAV serotypes in chimeric library
based on variant description of representatives and their
abundance the chimeric library
===================================================================

Output path: hafoe_out_sim_100_15/reports/serotype_distribution_chimeric_lib.pdf


Clustering enriched 1 library with chimeric library representatives
===================================================================

Program: cd-hit-est-2d
Command: /storage2/proj/kodikaz/softwares/cdhit/cd-hit-est-2d 
	 -i  
	 -o hafoe_out_sim_100_15/files/clstr_enriched1_lib/clstr_enr1.fasta 
	 -g 1 
	 -d 100 
	 -c 0.95 
	 -n 9 
	 -G 0 
	 -aL 0.95 
cd-hit-est path: /storage2/proj/kodikaz/softwares/cdhit/cd-hit-est-2d 
Input 1 (chimeric representatives) path: hafoe_out_sim_100_15/files/clstr_chimeric_lib/clstr_chim_new.fasta 
Input 2 (enriched library) path: hafoe_out_sim_100_15/files/Enriched1_ORF.fasta 
Output path: hafoe_out_sim_100_15/files/clstr_enriched1_lib 
Log path: hafoe_out_sim_100_15/log/cd_hit_est_2d_enriched1.log 
Sequence identity threshold, default 0.9 (-c): 0.95 
Identity type, default 1 (-G):  0 
	(if set to 1, use global sequence identity, 
	if set to 0, then use local sequence identity, 
	calculated as number of identical bases in alignment
	divided by the length of the alignment) 
Alignment coverage for the longer sequence, default 0.0 (-aL): 0.95 
word_length, default 10, see CD-HIT user's guide for choosing it (-n): 9 
memory limit (in MB) for the program, default 800, 0 for unlimitted (-M): 8000 

Number of clusters: 89
Cluster size summary statistics
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1.00    3.00   10.00   12.58   19.00   71.00 


Creating counts.csv summary table for representative enrichment
===================================================================

Output path: hafoe_out_sim_100_15/files/chimeric_lib_rep_counts.csv


Plotting top representatives' abundance in enriched 1 library
===================================================================

Output path: hafoe_out_sim_100_15/reports/top_rep_en1_barplot.pdf


Filter enriched, reduced representatives based on En1/Chim ratio
===================================================================

Output path for enriched: hafoe_out_sim_100_15/files/enriched_representatives.csv
Output path for reduced: hafoe_out_sim_100_15/files/reduced_representatives.csv
Output path for reduced: hafoe_out_sim_100_15/files/enriched_representatives.fasta
Output path for reduced: hafoe_out_sim_100_15/files/reduced_representatives.fasta

26 enriched sequences found.
43 reduced sequences found.


Plot enriched, reduced representatives based on En1/Chim ratio
===================================================================

Output path for enriched: hafoe_out_sim_100_15/reports/enriched_reps_en1.pdf
Output path for reduced: hafoe_out_sim_100_15/reports/reduced_reps_en1.pdf


Plotting variant description of enriched, reduced representatives
===================================================================

Output path: hafoe_out_sim_100_15/reports/variant_description_enriched.pdf
Output path: hafoe_out_sim_100_15/reports/variant_description_reduced.pdf


Multiple sequence alignment of enriched, reduced representatives
===================================================================

Output path: hafoe_out_sim_100_15/files/enriched_msa.clustal_num
Output path: hafoe_out_sim_100_15/files/reduced_msa.clustal_num

Command: /usr/bin/clustalo 

	 -i hafoe_out_sim_100_15/files/enriched_representatives.fasta 

	 -o hafoe_out_sim_100_15/files/enriched_msa.clustal_num 

	 --outfmt clu 

clustalo path: /usr/bin/clustalo 

Input path: hafoe_out_sim_100_15/files/enriched_representatives.fasta 

Output path: hafoe_out_sim_100_15/files/enriched_msa.clustal_num 
Command: /usr/bin/clustalo 
	 -i hafoe_out_sim_100_15/files/reduced_representatives.fasta 
	 -o hafoe_out_sim_100_15/files/reduced_msa.clustal_num 
	 --outfmt clu 
clustalo path: /usr/bin/clustalo 
Input path: hafoe_out_sim_100_15/files/reduced_representatives.fasta 
Output path: hafoe_out_sim_100_15/files/reduced_msa.clustal_num 


 Get conserved and gap regions from multiple sequence alignment
===================================================================

Output path: hafoe_out_sim_100_15/files/
Output path: hafoe_out_sim_100_15/files/


Plot variant description of enriched and reduced representatives
with conserved regions and gaps
===================================================================

Output path: hafoe_out_sim_100_15/reports/variant_description_enriched_conserved.pdf
Output path: hafoe_out_sim_100_15/reports/variant_description_reduced_conserved.pdf
